<!doctype html>
<!-- - - - - - - - - - - - - - - -->
<!-- dna.js                      -->
<!-- Visual Specification Runner -->
<!-- dnajs.org/spec/visual.html  -->
<!-- - - - - - - - - - - - - - - -->
<html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width, initial-scale=1">
<title>dna.js ~~ Specification Runner</title>
<link rel=icon       href=https://dnajs.org/graphics/bookmark.png>
<link rel=stylesheet href=../dist/dna.css>
<style>
   body                { font-family: system-ui, sans-serif; margin: 30px; }
   body >header        { display: flex; justify-content: space-between; margin-bottom: 30px; }
   body >footer        { text-align: center; background: silver; padding: 10px 10px; }
   h1, h3              { margin: 0px 0px 5px 0px; }
   h2                  { margin: 0px; }
   h4                  { margin: 0px; min-height: 1.6em; font-weight: normal; }
   p                   { margin: 0px 0px 3px 0px; }
   button              { font-size: 1.0rem; cursor: pointer; }
   label               { display: block; }
   output              { display: block; font-size: 0.9rem; margin-bottom: 8px; }
   output >samp        { display: block; background-color: lightsteelblue; padding: 3px 8px; border: 2px solid transparent; transition: border-color 400ms; }
   output >samp:nth-child(2n) { background-color: gainsboro; }
   output >samp:hover  { border-color: darkorange; }
   .in-a-row           { display: inline-block; }
   main >section       { display: inline-block; vertical-align: top; border: 1px solid silver;
                           padding: 10px; margin: 0px 20px 20px 0px; }
   fieldset            { float: left; width: 220px; border: 1px solid silver; padding-bottom: 0px; }
   legend              { border: 1px solid silver; padding: 0px 10px; }
   input[type=range]   { -webkit-appearance: none; width: 100%; height: 20px;
                           background-color: mintcream; border: 1px solid silver; }
   input[type=number]  { width: 7em; font-family: monospace; text-align: right; }
   [title]             { cursor: help; }
   [data-component]    { background-color: gainsboro; padding: 15px; }
   .dna-clone          { background-color: darkseagreen; }
   div.dna-clone       { padding: 10px; margin-bottom: 15px; }
   .dna-clone img      { width: 120px; }
   .color-change       { background-color: lightsteelblue; }
   .color-change2      { background-color: gold; }
   #back, .id-back     { background-color: honeydew; }
   .border-change      { border: 2px solid darkorange; }
   .border-change2     { border: 2px solid darkslateblue; }
   .chapter-box        { display: inline-block; background-color: lightsteelblue; padding: 15px; margin: 5px }
   [title=usd], [title=usd100], [title=jpy] { text-align: right; }
   body.error-detected { background-color: pink; }
   body:not(.minified-mode) .minified-show { display: none; }
   body.minified-mode       .minified-hide { display: none; }
</style>
<script>
   const spec = {};
</script>
</head>
<body>

<header>
   <div>
      <h1>dna.js <span class=version-number></span></h1>
      <h2>Visual Specification Runner</h2>
   </div>
   <nav>
      <p><button data-href=https://dnajs.org>dnajs.org</button></p>
      <p><button data-href=https://dnajs.org class=external-site>dnajs.org <span>(new tab)</span></button></p>
      <p><button data-href=https://dnajs.org data-target=project>dnajs.org <span>(target)</span></button></p>
      <p class=minified-hide><span>dna.dev.js</span> &mdash; <a href=visual-min.html>switch</a></p>
      <p class=minified-show><span>dna.min.js</span> &mdash; <a href=visual.html>switch</a></p>
   </nav>
</header>

<main>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec01>
   <h3>Specification: #01</h3>
   <p>Add 3 items and delete 1 item</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=s01-book class=dna-template>
            <div>Title:  <span>~~title~~</span></div>
            <div>Author: <cite>~~author~~</cite></div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>Title:  <span>The DOM</span></div>
            <div>Author: <cite>Jan</cite></div>
         </div>
         <div class=dna-clone>
            <div>Title:  <span>Howdy HTML5</span></div>
            <div>Author: <cite>Ed</cite></div>
         </div>
      </div>
   </fieldset>
</section>
<script>
spec.spec01 = {
   run() {
      const book1 = { title: 'The DOM',      author: 'Jan' };
      const book2 = { title: 'Styling CSS3', author: 'Abby' };
      const book3 = { title: 'Howdy HTML5',  author: 'Ed' };
      dna.clone('s01-book', book1);
      const clone = dna.clone('s01-book', book2);
      dna.clone('s01-book', book3);
      dna.destroy(clone);
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec02>
   <h3>Specification: #02</h3>
   <p>Add 2 items, empty, and add 1 item (with mustache)</p>
   <fieldset class=dna-hide>
      <legend>Actual</legend>
      <div class=book-list>
         <hr>
         <hr class=dna-hide>
         <div id=s02-book class=dna-template>
            <div data-class=~~class;sale,border-change~~>
               Title: <span>{{title}}</span>
            </div>
            <div data-class=~~sale,wow,border-change;class~~>
               Author: <cite data-class=~~sale,color-change~~>{{author}}</cite>
            </div>
         </div>
         <hr>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <hr>
         <div class=dna-clone>
            <div class=color-change>
               Title: <span class=color-change2>The One</span>
            </div>
            <div class="color-change border-change">
               Author: <cite>Lee</cite>
            </div>
         </div>
         <hr>
      </div>
   </fieldset>
</section>
<script>
spec.spec02 = {
   run() {
      const book1 = { title: 'The DOM',     author: 'Jan' };
      const book2 = { title: 'Howdy HTML5', author: 'Ed' };
      const book3 = { title: 'The One',     author: 'Lee', class: 'color-change', sale: false };
      dna.clone('s02-book', [book1, book2]);
      dna.empty('s02-book');
      const titleElem = dna.clone('s02-book', book1).find('span').first();
      titleElem.addClass('color-change2');
      dna.refresh(titleElem, { data: book3 });
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec03>
   <h3>Specification: #03</h3>
   <p>Add 3 items with fade (1st one blue) and top set to true</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <hr>
         <div id=s03-book class=dna-template>
            <div>Title:  <span>~~title~~</span></div>
            <div>Author: <cite>~~author~~</cite></div>
         </div>
         <hr>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <hr>
         <div class=dna-clone>
            <div>Title:  <span>3rd</span></div>
            <div>Author: <cite>Jan</cite></div>
         </div>
         <div class=dna-clone>
            <div>Title:  <span>2nd</span></div>
            <div>Author: <cite>Jan</cite></div>
         </div>
         <div class="dna-clone color-change">
            <div>Title:  <span>1<sup>st</sup> &bull;</span></div>
            <div>Author: <cite>Jan</cite></div>
         </div>
         <hr>
      </div>
   </fieldset>
</section>
<script>
spec.spec03 = {
   run() {
      const book1 = { title: '1<sup>st</sup> &bull;', author: 'Jan' };
      const book2 = { title: '2nd', author: 'Jan' };
      const book3 = { title: '3rd', author: 'Jan' };
      const options = { fade: true, top: true, html: true };
      dna.clone('s03-book', book1, options).addClass('color-change');
      dna.clone('s03-book', book2, options);
      dna.clone('s03-book', book3, options);
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec04>
   <h3>Specification: #04</h3>
   <p>Add 1 items with an image</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=s04-book class=dna-template>
            <div>Title:  <span>~~title~~</span></div>
            <div>Author: <cite>~~author~~</cite></div>
            <div>Cover: <img data-attr-src=~~image~~ src=# alt=cover></div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>Title:  <span>&lt;b&gt;Text&lt;/b&gt;&amp;bull;</span></div>
            <div>Author: <cite>Lee</cite></div>
            <div>Cover: <img src=https://dnajs.org/graphics/dnajs-logo.png alt=cover></div>
         </div>
      </div>
   </fieldset>
</section>
<script>
spec.spec04 = {
   run() {
      const book = {
         title:  '<b>Text</b>&bull;',
         author: 'Lee',
         image:  'https://dnajs.org/graphics/dnajs-logo.png'
         };
      dna.clone('s04-book', book);
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec05>
   <h3>Specification: #05</h3>
   <p>Add 2 items in an array twice</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list id=s05-book-list></div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>Title:    <span>1st!!</span></div>
            <div>Author:   <cite>Lee</cite></div>
            <div>Code:     <span>1100</span></div>
            <div>Location: <span>1</span></div>
         </div>
         <div class=dna-clone>
            <div>Title:  <span>2nd!!</span></div>
            <div>Author: <cite>Jan</cite></div>
            <div>Code:   <span>900</span></div>
            <div>Location: <span>2</span></div>
         </div>
         <div class="dna-clone color-change">
            <div>Title:  <span>1st!!!</span></div>
            <div>Author: <cite>Lee</cite></div>
            <div>Code:   <span>1100</span></div>
            <div>Location: <span>3</span></div>
         </div>
         <div class="dna-clone color-change">
            <div>Title:  <span>2nd!!!</span></div>
            <div>Author: <cite>Jan</cite></div>
            <div>Code:   <span>900</span></div>
            <div>Location: <span>4</span></div>
         </div>
      </div>
   </fieldset>
</section>
<script>
spec.spec05 = {
   html:
      '<div data-transform=spec.spec05.generateCode>' +
      '   <div>Title:    <span>~~title~~</span></div>' +
      '   <div>Author:   <cite>~~author~~</cite></div>' +
      '   <div>Code:     <span>~~code~~</span></div>' +
      '   <div>Location: <span>~~[count]~~</span></div>' +
      '</div>',
   generateCode(data) {
      data.code = data.author.charCodeAt(0) % 13 * 100;
      },
   run() {
      dna.createTemplate('s05-book', spec.spec05.html, $('#s05-book-list'));
      const book1 = { title: '1st', author: 'Lee' };  //code: 1100
      const book2 = { title: '2nd', author: 'Jan' };  //code: 900
      const bang = (book) => {
         book.title = book.title + '!';
         return book;
         };
      dna.clone('s05-book', [book1, book2], { transform: bang }).addClass('color-change');
      dna.clone('s05-book', [book1, book2], { transform: bang, empty: true });
      dna.clone('s05-book', [book1, book2], { transform: bang }).addClass('color-change');
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec06>
   <h3>Specification: #06</h3>
   <p>Add 1 item with attributes</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=s06-book class=dna-template data-class=~~extra~~>
            <div id=~~info.isbn~~ data-class=~~language,color-change,do-not-apply-this-class~~>
               Title: <span data-lang=~~language~~ data-attr-lang=~~language~~>~~title~~</span>
            </div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class="dna-clone border-change">
            <div id=123-expected class=color-change>
               Title: <span lang=fr class=color-change2>Les Attributs</span>
            </div>
         </div>
      </div>
   </fieldset>
</section>
<script>
spec.spec06 = {
   run() {
      const bouquin = {
         title:    'Les Attributs',
         info:     { isbn: 123 },
         language: 'fr',
         extra:    'border-change'
         };
      dna.clone('s06-book', bouquin);
      $('#123').find('[lang=fr]').addClass('color-change2');
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec07>
   <h3>Specification: #07</h3>
   <p>Embedded template with array of data</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=s07-book class=dna-template>
            <div>Author: <cite>~~author.name~~</cite></div>
            <div>
               <div id=s07-book-chapter class=dna-template>
                  <div>Chapter: <span>~~header~~</span><span>~~author.name~~</span></div>
               </div>
            </div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>Author: <cite>Ed</cite></div>
            <div>
            </div>
         </div>
         <div class=dna-clone>
            <div>Author: <cite>Jan</cite></div>
            <div>
               <div class="dna-clone color-change">
                  <div>Chapter: <span>Preface</span><span></span></div>
                  <div></div>
               </div>
               <div class="dna-clone color-change">
                  <div class=color-change>Chapter: <span>Index</span><span></span></div>
               </div>
            </div>
         </div>
         <div class=dna-clone>
            <div>Author: <cite>Lee</cite></div>
            <div>
            </div>
         </div>
      </div>
   </fieldset>
</section>
<script>
spec.spec07 = {
   run() {
      const book1 = { author: { name: 'Ed' } };
      const book2 = { author: { name: 'Jan' } };
      const book3 = { author: { name: 'Lee' } };
      dna.clone('s07-book', book1);
      const clone = dna.clone('s07-book', book2);
      const chapters = [{ header: 'Preface' }, { header: 'Index' }]
      dna.clone('s07-book-chapter', chapters, { container: clone }).addClass('color-change');
      dna.clone('s07-book', book3);
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec08>
   <h3>Specification: #08</h3>
   <p>Add 2 items and refresh</p>
   <fieldset>
      <legend>Actual</legend>
      <p>
         Authors (1):
         <span id=s08-book-authors1 class=dna-template data-separator=", " data-last-separator=" and ">
            <span>~~[value]~~</span>
         </span>
      </p>
      <p>
         Authors (2):
         <span id=s08-book-authors2 class=dna-template data-separator=", " data-last-separator=" and ">
            <span>~~[value]~~</span>
         </span>
      </p>
      <p>
         Authors (3):
         <span id=s08-book-authors3 class=dna-template data-separator=", " data-last-separator=" and ">
            <span>~~[value]~~</span>
         </span>
      </p>
      <div class=book-list>
         <div id=s08-book class=dna-template>
            <div>Title:   <span>~~title~~</span></div>
            <div>Authors:
               <span data-array=~~authors~~>
                  *<span data-callback=spec08var.configure>~~[value]~~</span>
               </span>
            </div>
            <div data-callback=spec08constConfigure>Score:   <span>~~score~~</span></div>
            <div>On Sale: <span data-callback=spec08letConfigure>~~sale~~</span></div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <p>
         Authors (1):
         <span class=dna-clone>Jan</span>
      </p>
      <p>
         Authors (2):
         <span class=dna-clone>Jan and </span>
         <span class=dna-clone>Bo</span>
      </p>
      <p>
         Authors (3):
         <span class=dna-clone>Jan, </span>
         <span class=dna-clone>Bo and </span>
         <span class=dna-clone>Ed</span>
      </p>
      <div class=book-list>
         <div class=dna-clone>
            <div>Title: <span>The New DOM</span></div>
            <div>Authors: <span>
               *<span class=color-change2>Jan II</span></span><span>
               *<span class=color-change2>Bo</span></span>
            </div>
            <div class=color-change>Score: <span>81</span></div>
            <div>On Sale: <span class=color-change2>true</span></div>
         </div>
         <div class="dna-clone border-change">
            <div>Title: <span>Howdy HTML5</span></div>
            <div>Authors: <span>
               *<span class=color-change2>Ed II</span></span>
            </div>
            <div class=color-change>Score: <span>97</span></div>
            <div>On Sale: <span class=color-change2>false</span></div>
         </div>
      </div>
   </fieldset>
</section>
<script>
var spec08var = { configure(elem) { elem.addClass('color-change2') } };
const spec08constConfigure = (elem) => elem.addClass('color-change');
let   spec08letConfigure =   (elem) => elem.addClass('color-change2');
spec.spec08 = {
   run() {
      dna.clone('s08-book-authors1', ['Jan']);
      dna.clone('s08-book-authors2', ['Jan', 'Bo']);
      dna.clone('s08-book-authors3', ['Jan', 'Bo', 'Ed']);
      const book1 = { title: 'The DOM',     authors: ['Jan'],          score: 77, sale: false };
      const book2 = { title: 'The New DOM', authors: ['Jan II', 'Bo'], score: 81, sale: true };
      const book3 = { title: 'Howdy HTML5', authors: ['Ed'],           score: 92, sale: false };
      //clone #1
      const clone1 = dna.clone('s08-book', book1);
      let modelOk = dna.getModel(clone1).title === book1.title;  //verify initial model
      dna.refresh(clone1, { data: book2 });
      //clone #2
      const clone2 = dna.clone('s08-book', book3);
      dna.getModel(clone2).authors = ['Ed II'];
      dna.getModel(clone2).score = 97;
      dna.refreshAll('s08-book');
      modelOk = modelOk && dna.getModel('s08-book')[1].score === 97;  //verify updated model
      clone2.addClass(modelOk ? 'border-change' : 'color-change');
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec09>
   <h3>Specification: #09</h3>
   <p>
      Add 2 items
      (<span><span id=s09-rest-link class=dna-template>
         <button data-href=~~[value]~~ class=external-site>book <span>~~[count]~~</span></button>
         <span class=dna-separator>and</span>
      </span></span>)
      loaded from REST call
   </p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=s09-book class=dna-template>
            <div>Title:  <span>~~title~~</span></div>
            <div>Author: <cite>~~author~~</cite></div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>Title:  <span>Go JavaScript</span></div>
            <div>Author: <cite>Jake</cite></div>
         </div>
         <div class=dna-clone>
            <div>Title:  <span>Styling CSS3</span></div>
            <div>Author: <cite>Abby</cite></div>
         </div>
      </div>
   </fieldset>
</section>
<script>
spec.spec09 = {
   run() {
      dna.clone('s09-rest-link', ['https://dnajs.org/api/books/1/', 'https://dnajs.org/api/books/2/']);
      const insertBook = (book) => dna.clone('s09-book', book, { top: book.id === 1, fade: true });
      fetchJson.enableLogger();
      fetchJson.get('https://dnajs.org/api/books/1/').then(insertBook);
      fetchJson.get('https://dnajs.org/api/books/2/').then(insertBook);
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec10>
   <h3>Specification: #10</h3>
   <p>Add 1 item 3 times and apply callback function</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=s10-book class=dna-template>
            <div>~~title~~</div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone
            style="height: 60px; color: white; background-image: url(https://dnajs.org/graphics/dnajs-logo.png); background-size: 80px;">
            <div>Background</div>
         </div>
         <div class=dna-clone
            style="height: 60px; color: white; background-image: url(https://dnajs.org/graphics/dnajs-logo.png); background-size: 80px;">
            <div>Background</div>
         </div>
         <div class=dna-clone
            style="height: 60px; color: white; background-image: url(https://dnajs.org/graphics/dnajs-logo.png); background-size: 80px;">
            <div>Background</div>
         </div>
      </div>
   </fieldset>
</section>
<script>
spec.spec10 = {
   run() {
      const applyBackgnd = (elem, data) => elem.css({
         height:          '60px',
         color:           'white',
         backgroundImage: data.image,
         backgroundSize:  '80px',
         });
      const book = { title: 'Background', image: 'url(https://dnajs.org/graphics/dnajs-logo.png)' };
      const options = { fade: true, callback: applyBackgnd, clones: 3 };
      dna.clone('s10-book', book, options);
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec11>
   <h3>Specification: #11</h3>
   <p>Add 2 items with missing fields</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=s11-book class=dna-template>
            <div>Title:
               <span data-require=~~title~~>~~title~~</span>
               <span data-missing=~~title~~><i>[Gone with the Wind]</i></span>
            </div>
            <div data-require=~~author~~>Author: <cite>~~author~~</cite></div>
            <div data-missing=~~author~~><i>[no author]</i></div>
            <div data-true=~~available~~>Available</div>
            <div data-false=~~available~~>Out of stock</div>
            <div data-true=~~onSale~~>ON SALE!</div>
            <div data-false=~~onSale~~>Regular price</div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>Title:
               <span><i>[Gone with the Wind]</i></span>
            </div>
            <div>Author: <cite>Jan</cite></div>
            <div>Available</div>
            <div>ON SALE!</div>
         </div>
         <div class=dna-clone>
            <div>Title:
               <span>Howdy HTML5</span>
            </div>
            <div><i>[no author]</i></div>
            <div>Out of stock</div>
            <div>Regular price</div>
         </div>
      </div>
   </fieldset>
</section>
<script>
spec.spec11 = {
   run() {
      const book1 = { author: 'Jan',        available: 1, onSale: 'true' };
      const book2 = { title: 'Howdy HTML5', available: 0, onSale: [] };
      dna.clone('s11-book', book1);
      dna.clone('s11-book', book2);
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec12>
   <h3>Specification: #12</h3>
   <p>Array field (sub-template)</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=s12-book class=dna-template data-title=~~title~~>
            <div>
               Title: <span>~~title~~</span>
            </div>
            Authors:
            <span>
               <span data-array=~~authors~~ data-author=~~[value]~~>
                  (<span>~~[count]~~</span>)
                  <cite>~~[value]~~</cite>
               </span>
            </span>
            <div class=color-change data-array=~~chapters~~>
               <span>~~[count]~~</span>.
               <span data-class=~~type~~ data-type=~~type~~>~~type~~</span>:
               <span id=~~type~~>~~header~~</span>
               <nav>
                  <button data-click=dna.up>&uarr;</button>
                  <button data-click=dna.down>&darr;</button>
                  <button data-click=dna.bye>&times;</button>
               </nav>
            </div>
            <div><button data-click=spec.spec12.recount>Recount</button></div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class="dna-clone border-change">
            <div>Title: <span>The DOM</span></div>
            Authors:
            <span>
               <span class=dna-clone>                (1) <cite>Bo I</cite></span>
               <span class="dna-clone color-change"> (2) <cite>Bo II</cite></span>
            </span>
            <div><button>Recount</button></div>
         </div>
         <div class=dna-clone>
            <div>Title: <span>Howdy HTML5</span></div>
            Authors:
            <span>
               <span class=dna-clone>                 (1) <cite>Ed</cite></span>
               <span class="dna-clone color-change2"> (2) <cite>Jake</cite></span>
               <span class=dna-clone>                 (3) <cite>Abby</cite></span>
            </span>
            <div class="dna-clone color-change">
               <span>1. front</span>:
               <span class=id-front>Preface &amp;star;</span>
               <nav>
                  <button>&uarr;</button>
                  <button>&darr;</button>
                  <button>&times;</button>
               </nav>
            </div>
            <div class="dna-clone color-change">
               <span>2. back</span>:
               <span class=id-back>Index</span>
               <nav>
                  <button>&uarr;</button>
                  <button>&darr;</button>
                  <button>&times;</button>
               </nav>
            </div>
            <div><button>Recount</button></div>
         </div>
         <div class=dna-clone>
            <div>Title: <span>Styling CSS3</span></div>
            Authors:
            <span>
            </span>
            <div><button>Recount</button></div>
         </div>
         <div class="dna-clone border-change">
            <div>Title: <span>Howdy HTML5</span></div>
            Authors:
            <span>
               <span class=dna-clone>                 (1) <cite>Ed</cite></span>
               <span class="dna-clone color-change2"> (2) <cite>Jake</cite></span>
               <span class=dna-clone>                 (3) <cite>Abby</cite></span>
            </span>
            <div class="dna-clone color-change">
               <span>1. front</span>:
               <span class=id-front>Preface &star;</span>
               <nav>
                  <button>&uarr;</button>
                  <button>&darr;</button>
                  <button>&times;</button>
               </nav>
            </div>
            <div class="dna-clone color-change">
               <span>2. back</span>:
               <span class=id-back>Index</span>
               <nav>
                  <button>&uarr;</button>
                  <button>&darr;</button>
                  <button>&times;</button>
               </nav>
            </div>
            <div class="dna-clone color-change">
               <span>3. back</span>:
               <span class=id-back>Bio</span>
               <nav>
                  <button>&uarr;</button>
                  <button>&darr;</button>
                  <button>&times;</button>
               </nav>
            </div>
            <div class="dna-clone color-change">
               <span>5. back</span>:
               <span class=id-back>Bio 3</span>
               <nav>
                  <button>&uarr;</button>
                  <button>&darr;</button>
                  <button>&times;</button>
               </nav>
            </div>
            <div class="dna-clone color-change">
               <span>6. back</span>:
               <span class=id-back>Bio X</span>
               <nav>
                  <button>&uarr;</button>
                  <button>&darr;</button>
                  <button>&times;</button>
               </nav>
            </div>
            <div><button>Recount</button></div>
         </div>
      </div>
   </fieldset>
</section>
<script>
spec.spec12 = {
   recount(button) {
      const isFourthBook = dna.getClone(button).index() === 3;
      dna.recount(button.parent().prev().filter('.dna-sub-clone'), { html: isFourthBook });
      },
   run() {
      const chapters = [
         { header: 'Preface &star;', type: 'front' },
         { header: 'Index',          type: 'back' }
         ];
      const moreChapters = [
         { header: 'Bio 2', type: 'back' },
         { header: 'Bio 3', type: 'back' }
         ];
      const lastChapter =
         { header: 'Bio X', type: 'back' };
      const authors = ['Ed', 'Jake', 'Abby'];
      const book1 = { title: 'The DOM' };
      const book2 = { title: 'Howdy HTML5',  authors: authors, chapters: chapters };
      const book3 = { title: 'Styling CSS3', authors: [],      chapters: [] };
      dna.clone('s12-book', [book1, book2, book3, book1], { html: false });
      dna.cloneSub(dna.getClones('s12-book').first(), 'authors', 'Bo I');
      dna.cloneSub(dna.getClones('s12-book').first(), 'authors', 'Bo II');
      let clone = $('.s12-book').first();
      clone.toggleClass('border-change', clone.data().title === 'The DOM');
      const elem = clone.find('.s12-book-authors-instance').last();
      elem.addClass(elem.data().author === 'Bo II' ? 'color-change' : 'color-change2');
      clone = dna.refresh($('.s12-book').last(), { data: book2, html: true });
      dna.cloneSub(clone, 'chapters', { header: 'Bio', type: 'back' });
      dna.cloneSub(clone, 'chapters', moreChapters);
      dna.destroy($('.s12-book').find(':contains(Bio 2)'), { main: false });
      dna.cloneSub(clone, 'chapters', lastChapter);
      clone.toggleClass('border-change', dna.getModel(clone).chapters.length === 5);
      $('.s12-book').find('[data-author=Jake]').addClass('color-change2');
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec13>
   <h3>Specification: #13</h3>
   <p>Security</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=s13-book class=dna-template>
            Title: <span>~~[value]~~</span>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            Title: <span>&lt;script&gt;alert(1);&lt;/script&gt;</span>
         </div>
         <div class=dna-clone>
            Title: <span>&lt;script&gt;alert(2);&lt;/script&gt;</span>
         </div>
         <div class=dna-clone>
            Title: <span>3</span>
         </div>
      </div>
   </fieldset>
</section>
<script>
spec.spec13 = {
   run() {
      dna.clone('s13-book', '<script>alert(1);<\/script>');
      dna.clone('s13-book', '<script>alert(2);<\/script>', { html: false });
      dna.clone('s13-book', '<script>$(".s13-book").last().find("span").text(3);<\/script>', { html: true });
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec14>
   <h3>Specification: #14</h3>
   <p>Simple array with rearrange and delete</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=s14-book class=dna-template data-count=~~[count]~~>
            <div>
               <button data-click=dna.up>&uarr;</button>
               <button data-click=dna.down>&darr;</button>
               <button data-click=dna.bye>&times;</button>
            </div>
            Book #<span>~~[count]~~</span>: <span>~~[value]~~</span>
         </div>
      </div>
      <div id=s14-book-placeholder class=dna-template></div>
      <div data-placeholder=s14-book-placeholder><i>Placeholder</i></div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>
               <button>&uarr;</button>
               <button>&darr;</button>
               <button>&times;</button>
            </div>
            Book #<span>1</span>: <span>The DOM</span>
         </div>
         <div class=dna-clone>
            <div>
               <button>&uarr;</button>
               <button>&darr;</button>
               <button>&times;</button>
            </div>
            Book #<span>2</span>: <span>Howdy HTML5</span>
         </div>
         <div class="dna-clone border-change">
            <div>
               <button>&uarr;</button>
               <button>&darr;</button>
               <button>&times;</button>
            </div>
            Book #<span>3</span>: <span>Styling CSS3</span>
         </div>
      </div>
      <div><i>Placeholder</i></div>
   </fieldset>
</section>
<script>
spec.spec14 = {
   run() {
      const books = ['The DOM', 'Howdy HTML5', 'Styling CSS3'];
      dna.clone('s14-book', books);
      const countIsThree = (i, elem) => parseInt($(elem).data().count) === 3;
      dna.getClones('s14-book').filter(countIsThree).addClass('border-change');
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec15>
   <h3>Specification: #15</h3>
   <p>Events</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=s15-book class=dna-template data-callback=spec.spec15.configure>
            <div class=surrounded>
               <span class=count>~~[count]~~</span>: <span>~~[value]~~</span>
               <button data-click=spec.spec15.animal>
                  🐅
                  <b>🐒</b>
                  <b data-click=spec.spec15.elephant>🐘
                     <span data-click=spec.spec15.mouse>🐁</span>
                  </b>
                  <b data-hover-in=spec.spec15.ufoIn>
                     <span data-hover-out=spec.spec15.ufoOut>🛸</span>
                  </b>
               </button>
            </div>
            <button class=1 data-click=dna.bye>Bye 1</button>
            <button class=2>Bye 2</button>
            <button class=3 data-click=spec.spec15.bye>Bye 3</button>
         </div>
      </div>
      <div data-placeholder=s15-book>No more clones!</div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class="dna-clone color-change border-change2">
            <div class=border-change style="color: white; padding: 10px;">
               <span class=count>3</span>: <span>Howdy HTML5</span>
               <button> 🐅 <b>🐒</b> <b>🐘 <span>🐁</span> </b> <b> <span>🛸</span> </b> </button>
            </div>
            <button>Bye 1</button>
            <button>Bye 2</button>
            <button>Bye 3</button>
         </div>
         <div class="dna-clone color-change border-change2">
            <div class=border-change style="color: white; padding: 10px;">
               <span>5</span>: <span>Styling CSS3</span>
               <button> 🐅 <b>🐒</b> <b>🐘 <span>🐁</span> </b> <b> <span>🛸</span> </b> </button>
            </div>
            <button>Bye 1</button>
            <button>Bye 2</button>
            <button>Bye 3</button>
         </div>
         <hr><hr><hr><hr><hr><hr><hr><hr>
      </div>
   </fieldset>
</section>
<script>
spec.spec15 = {
   configure(elem) {
      elem.addClass('color-change');
      },
   showMessage(message, elem) {
      const tag = '<' + elem[0].nodeName + '>'
      const msec = String(Date.now() % 10000).padStart(4, '0');
      const p = $('<p>').text([msec, message, tag].join(' '));
      $('#spec15 fieldset').first().append(p);
      },
   animal(elem) {
      spec.spec15.showMessage('animal', elem);
      },
   elephant(elem) {
      spec.spec15.showMessage('elephant', elem);
      },
   mouse(elem) {
      spec.spec15.showMessage('mouse', elem);
      },
   ufoIn(elem) {
      spec.spec15.showMessage('⎍⎎⍜ hover', elem);
      },
   ufoOut(elem) {
      spec.spec15.showMessage('⎍⎎⍜ bye', elem);
      },
   surround(elem) {
      elem.addClass('border-change');
      const addHr = () => $('#spec15 fieldset').first().append('<hr>');
      elem.each(addHr);  //exactly 8 times (one for each clone)
      },
   surround2(elem) {
      if (!elem.hasClass('s15-book'))
         throw 'This is not the clone you are looking for: ' + (elem[0] && elem[0].nodeName);
      elem.addClass('border-change2');
      },
   bye(elem, event) {
      const clone = dna.getClone(elem);
      const delayRange = { min: 300, max: 1600 };
      const start = Date.now();
      let handled = false;
      const badNews = (msg) => { throw 'handleByeDone --> ' + msg; };
      const handleByeDone = (param) => {
         const delay = Date.now() - start;
         const elemMissing = param[0] !== clone[0];
         const inDom = !!clone.parent().length;
         handled = true;
         if (delay < delayRange.min || delay > delayRange.max || elemMissing || inDom)
            badNews('delay: ' + delay + 'ms, clone: ' + !elemMissing + ' removed: ' + !inDom);
         };
      if (event.type === 'click')
         dna.bye(elem, handleByeDone);
      if (event.type === 'click')
         window.setTimeout(() => handled || badNews('delay exceeded: ' + delayRange.max), delayRange.max);
      },
   run() {
      dna.registerInitializer('spec.spec15.surround', { selector: '.surrounded' });
      dna.registerInitializer('css', { selector: '.surrounded', params: { color: 'white' } });
      dna.registerInitializer('css', { selector: '.surrounded', params: ['padding', '10px'] });
      dna.registerInitializer(spec.spec15.surround2, { onDocLoad: false });  //apply to each clone
      const titles = ['NUKE', 'NUKE', 'Howdy HTML5', 'NUKE', 'Styling CSS3', 'NUKE', 'NUKE', 'NUKE'];
      dna.clone('s15-book', titles);
      $('.s15-book button.2').on({ click: dna.bye });  //add handler
      const getClone = (count) => $('.s15-book .count:contains(' + count + ')').closest('.dna-clone');
      getClone(1).find('button.1').trigger('click');         //nuke 1st (bye w/data-click)
      getClone(2).find('button.2').trigger('click');         //nuke 2nd (bye w/event handler)
      getClone(8).find('button.3').trigger('click');         //nuke 8th (remove w/dna click callback)
      dna.bye(getClone(4));                                  //nuke 4th (bye w/jQuery elem)
      dna.getClone(getClone(7).find('span:last')).remove();  //nuke 7th (remove w/sub-node)
      getClone(6).each(dna.bye);                             //nuke 6th (bye w/jQuery loop)
      dna.clearInitializers();
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec16>
   <h3>Specification: #16</h3>
   <p>Input tag properties (minimized attributes)</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=s16-book class=dna-template>
            <p>Title: <input value=~~title~~></p>
            Options:
            <div>
               <label data-array=~~options~~ data-class=~~set,border-change,border-change2~~>
                  <input type=checkbox value=~~code~~ data-prop-checked=~~set~~>
                  <span>~~name~~</span> [<span>~~[count]~~</span>]
               </label>
            </div>
            Cover:
            <div>
               <label data-array=~~covers~~ data-input-name=cover data-class=~~set,border-change~~>
                  <input type=radio value=~~code~~ name=cover
                     data-prop-disabled=~~unavailable~~ data-prop-checked=~~set~~>
                  <span>~~name~~</span> [<span>~~[count]~~</span>]
               </label>
            </div>
            Purpose:
            <select data-option=~~purpose~~>
               <option data-array=~~purposes~~ value=~~code~~>~~name~~</option>
            </select>
            <hr>
            Category:
            <div>
               <select data-option=~~category~~>
                  <option value=art>Art</option>
                  <option value=computers>Computers</option>
                  <option value=nature>Nature</option>
               </select>
               <code>~~category~~</code>
            </div>
            Tags:
            <p>
               <span data-array=~~meta.info.tags~~ class=in-a-row>
                  <input value=~~english.code~~ size=10>
                  <code>~~english.code~~</code>
               </span>
            </p>
            Secret:
            <p>
               <span class=in-a-row>
                  <input value=~~secret~~ size=10 type=password>
                  <code>~~secret~~</code>
               </span>
               <textarea>~~secret~~</textarea>
            </p>
            Published:
            <p>
               <input data-attr-type=date value=~~pubDate~~><br>
               <code>~~pubDate~~</code>
            </p>
            Cover Color:
            <p>
               <input data-attr-type=color value=~~coverColor~~>
               <code>~~coverColor~~</code>
            </p>
            Note (2s smart updates):
            <p>
               <input data-smart-update=spec.spec16.submitNote data-smart-throttle=2000 value=~~note~~><br>
               <code>~~note~~</code>
            </p>
         </div>
      </div>
      <div>
         <div id=note class=dna-template><small><b>~~ms~~</b></small>: <code>~~note~~</code></div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <p>Title: <input value="The DOM!" class=border-change></p>
            Options:
            <div>
               <label class=border-change>
                  <input type=checkbox value=fast checked>
                  <span>Overnight [1]</span>
               </label>
               <label class=border-change2>
                  <input type=checkbox value=share>
                  <span>Social Share [2]</span>
               </label>
               <label class=border-change>
                  <input type=checkbox value=gift checked>
                  <span>Gift [3]</span>
               </label>
            </div>
            Cover:
            <div>
               <label>
                  <input type=radio value=soft name=cover-expected>
                  <span>Paperback [1]</span>
               </label>
               <label class=border-change>
                  <input type=radio value=hard name=cover-expected checked>
                  <span>Hardcover [2]</span>
               </label>
               <label>
                  <input type=radio value=ebook name=cover-expected disabled>
                  <span>Digital [3]</span>
               </label>
            </div>
            Purpose:
            <select class=border-change>
               <option value=work>Business</option>
               <option value=fun selected>Personal</option>
               <option value=edu>School</option>
            </select>
            <hr>
            Category:
            <div>
               <select>
                  <option value=art>Art</option>
                  <option value=computers selected>Computers</option>
                  <option value=nature>Nature</option>
               </select>
               <code>computers</code>
            </div>
            Tags:
            <p>
               <span class=in-a-row>
                  <input value=tech size=10>
                  <code>tech</code>
               </span>
               <span class=in-a-row>
                  <input value=color size=10>
                  <code>color</code>
               </span>
            </p>
            Secret:
            <p>
               <span class=in-a-row>
                  <input value="0xDEADBEEF" size=10 type=password>
                  <code>0xDEADBEEF</code>
               </span>
               <textarea>0xDEADBEEF</textarea>
            </p>
            Published:
            <p>
               <input type=date value=2014-06-22><br>
               <code>2014-06-22</code>
            </p>
            Cover Color:
            <p>
               <input type=color value=#daa520>
               <code>#daa520</code>
            </p>
            Note (2s smart updates):
            <p>
               <input value="Award winning"><br>
               <code>Award winning</code>
            </p>
         </div>
      </div>
   </fieldset>
</section>
<script>
spec.spec16 = {
   start: Date.now(),
   submitNote(elem) {
      const time = Date.now() - spec.spec16.start;
      dna.clone('note', { ms: time, note: elem.val() }, { top: true, fade: true });
      },
   run() {
      const options = [
         { code: 'fast',  name: 'Overnight',    set: false },
         { code: 'share', name: 'Social Share', set: false },
         { code: 'gift',  name: 'Gift',         set: false }
         ];
      const covers = [
         { code: 'soft',  name: 'Paperback', unavailable: 0, set: 1 },  //selected
         { code: 'hard',  name: 'Hardcover', unavailable: 0, set: 0 },
         { code: 'ebook', name: 'Digital',   unavailable: 1, set: 0 }
         ];
      const purposes = [
         { code: 'work', name: 'Business' },
         { code: 'fun',  name: 'Personal' },
         { code: 'edu',  name: 'School' }
         ];
      const book = {
         title:      '[change me]',
         options:    options,
         covers:     covers,
         purpose:    'edu',
         purposes:   purposes,
         category:   'computers',
         meta:       { info: { tags: [{ english: { code: 'tech' } },  { english: { code: 'color' } }] } },  //verify dot notation
         secret:     '[change me]',
         pubDate:    '2014-06-22',
         coverColor: '#daa520',
         note:       '[change me]'
         };
      const clone = dna.clone('s16-book', book);
      dna.updateField(clone.find('input:checkbox[value=fast]'), true);
      dna.updateField(clone.find('textarea'), '0xDEADBEEF');
      dna.updateField(clone.find('input').last(), 'Award winning');
      const titleElem = clone.find('input:text').first().val('The DOM!').trigger('change');  //simulate user edit
      titleElem.toggleClass('border-change', book.title === 'The DOM!');
      if (clone.find('input[value=fast]').prop('checked'))  //expect "Overnight" selected
         clone.find('input[value=gift]').trigger('click');  //also select "Gift" option
      if (clone.find('input[name=cover]:checked').val() === 'soft')  //expect "Paperback" selected
         clone.find('input[value=hard]').prop({ checked: true }).trigger('click');  //change to "Hardcover"
      const purposeElem = clone.find('select').first();
      if (purposeElem.val() === 'edu')  //expect "School" selected
         purposeElem.val('fun').trigger('change');  //change to "Personal"
      purposeElem.toggleClass('border-change', book.purpose === 'fun');
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec17>
   <h3>Specification: #17</h3>
   <p>Reusable component</p>
   <fieldset>
      <legend>Actual</legend>
      <!-- Component: start -->
      <div data-component=bookshelf data-on-load=bookshelf.setup data-msg=Hello!>
         <h2 data-click=bookshelf.showMsg>Bookshelf</h2>
         <button>View book data</button>
         <div id=s17-book class=dna-template>
            <div>Title:  <b>~~title~~</b></div>
            <div>Author: <cite>~~author~~</cite></div>
         </div>
         <script>
            const bookshelf = {
               showMsg(elem, event, component) {
                  elem.text(component.data().msg + event.timeStamp);
                  },
               setup(elem, component) {
                  const booksUrl = 'https://dnajs.org/api/books/';
                  component.children('button')
                     .attr({ 'data-href': booksUrl })
                     .addClass('external-site');
                  const handle = (data) => dna.clone('s17-book', data);
                  fetchJson.get(booksUrl).then(handle);
                  }
               };
         </script>
      </div>
      <!-- Component: end -->
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div data-component=bookshelf>
         <h2>Bookshelf</h2>
         <button>View book data</button>
         <div class=dna-clone>
            <div>Title:  <b>Go JavaScript</b></div>
            <div>Author: <cite>Jake</cite></div>
         </div>
         <div class=dna-clone>
            <div>Title:  <b>Styling CSS</b></div>
            <div>Author: <cite>Abby</cite></div>
         </div>
         <div class=dna-clone>
            <div>Title:  <b>Howdy HTML5</b></div>
            <div>Author: <cite>Ed</cite></div>
         </div>
      </div>
   </fieldset>
</section>
<script>
spec.spec17 = {
   run() {
      // Nothing to do as component knows how to initialize itself.
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec18>
   <h3>Specification: #18</h3>
   <p>Smooth container and pulse button</p>
   <fieldset>
      <legend>Actual</legend>
      <input type=range value=3 data-change=spec.spec18.smooth>
      <div class=smooth-container>
         <p id=chapter-box class=dna-template>~~[count]~~</p>
      </div>
      <button data-click=dna.ui.pulse>Pulse</button>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <input type=range value=5>
      <div>
         <p class=chapter-box>1</p>
         <p class=chapter-box>2</p>
         <p class=chapter-box>3</p>
      </div>
      <button>Pulse</button>
   </fieldset>
</section>
<script>
spec.spec18 = {
   iEvent(elem, event) {
      console.log(Date.now(), elem.val(), event.type);
      },
   makeChapterBoxes(range) {
      dna.clone('chapter-box', {}, { empty: true, clones: +range.val() }).hide().fadeIn();
      },
   smooth(range) {
      dna.ui.smoothHeightSetBaseline($('#spec18 .smooth-container'));
      spec.spec18.makeChapterBoxes(range);
      dna.ui.smoothHeightAnimate();
      },
   run() {
      spec.spec18.makeChapterBoxes($('#spec18 input[type=range]').first());
      const clickButton = () => $('#spec18 button[data-click]').trigger('click');
      window.setInterval(clickButton, 3000);
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec19>
   <h3>Specification: #19</h3>
   <p>Panels - nav buttons</p>
   <fieldset>
      <legend>Actual</legend>
      <nav class=dna-menu data-callback=spec.spec19.displayPanel>
         <button id=s19-book-title class=dna-template>~~title~~</button>
      </nav>
      <div class=dna-panels>
         <section id=s19-book class=dna-template data-transform=spec.spec19.enhance>
            <h2>~~title~~</h2>
            <cite>~~author~~</cite>
            <p>~~displayPrice~~</p>
            <p data-true=sale>On SALE</p>
         </section>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <nav>
         <button class=dna-clone>The DOM</button>
         <button class=dna-clone>Styling CSS3</button>
         <button class=dna-clone>Howdy HTML5</button>
      </nav>
      <div>
         <section class="dna-clone border-change">
            <h2>Styling CSS3</h2>
            <cite>Abby</cite>
            <p>$19.99</p>
            <p>On SALE</p>
         </section>
      </div>
   </fieldset>
</section>
<script>
spec.spec19 = {
   enhance(data) {
      data.code = dna.util.toKebab(data.title);
      data.displayPrice = '$' + (data.price / 100).toFixed(2);
      },
   displayPanel(elem) {
      return elem.addClass('border-change');
      },
   run() {
      dna.clone('s19-book-title', specRunner.catalog);
      dna.clone('s19-book',       specRunner.catalog);
      $('#spec19 .dna-menu .menu-item:contains(Styling CSS3)').trigger('click');
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec20>
   <h3>Specification: #20</h3>
   <p>Panels - nested</p>
   <fieldset>
      <legend>Actual</legend>
      <ul class=dna-menu data-nav=s20-books>
         <li><div>Web</div>
            <ul>
               <li><div>Technologies</div>
                  <ol>
                     <li class=menu-item>HTML</li>
                     <li class=menu-item>CSS</li>
                  </ol>
               </li>
               <li><div>Organizations</div>
                  <ol>
                     <li class=menu-item>W3C</li>
                  </ol>
               </li>
            </ul>
         </li>
         <li><div>Networking</div>
            <ol>
               <li class=menu-item>Protocols</li>
               <li class=menu-item>Equipment</li>
            </ol>
         </li>
      </ul>
      <div class=dna-panels data-nav=s20-books>
         <p>HTML!</p>
         <p>CSS!</p>
         <p>W3C!</p>
         <p>Protocals!</p>
         <p>Equipment!</p>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <ul>
         <li><div>Web</div>
            <ul>
               <li><div>Technologies</div>
                  <ol>
                     <li>HTML</li>
                     <li>CSS</li>
                  </ol>
               </li>
               <li><div>Organizations</div>
                  <ol>
                     <li>W3C</li>
                  </ol>
               </li>
            </ul>
         </li>
         <li><div>Networking</div>
            <ol>
               <li>Protocols</li>
               <li>Equipment</li>
            </ol>
         </li>
      </ul>
      <div>
         <p>W3C!</p>
      </div>
   </fieldset>
</section>
<script>
spec.spec20 = {
   run() {
      const postRenderClick = () => $('#spec20 .dna-menu .menu-item:contains(W3C)').trigger('click');
      window.setTimeout(postRenderClick, 1000);
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec21>
   <h3>Specification: #21</h3>
   <p>Panels - drop-down</p>
   <fieldset>
      <legend>Actual</legend>
      <select class=dna-menu>
         <option id=s21-book-author-nav-button class=dna-template
            value=~~author~~>~~author~~</option>
      </select>
      <div class=dna-panels>
         <section id=s21-book-author class=dna-template>
            <h3>Details</h3>
            <p>Author:   <cite>~~author~~</cite></p>
            <p>Language: <code>~~language~~</code></p>
         </section>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <select>
         <option>Jan</option>
         <option selected>Abby</option>
         <option>Ed</option>
      </select>
      <div>
         <section class=dna-clone>
            <h3>Details</h3>
            <p>Author:   <cite>Abby</cite></p>
            <p>Language: <code>fr</code></p>
         </section>
      </div>
   </fieldset>
</section>
<script>
spec.spec21 = {
   run() {
      dna.clone('s21-book-author-nav-button', specRunner.catalog);
      dna.clone('s21-book-author',            specRunner.catalog);
      $('#spec21 .dna-menu').val('Abby').trigger('change');
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec22>
   <h3>Specification: #22</h3>
   <p>Insert</p>
   <fieldset>
      <legend>Actual</legend>
      <hr>
      <div id=s22-summary class=dna-template>
         <h3>Summary</h3>
         <p>Number of books: <b>~~numBooks~~</b></p>
         <p>Total price: $<b>~~totalPrice~~</b></p>
      </div>
      <hr>
      <div id=s22-analytics class=dna-template>
         <h3>Analytics</h3>
         <span>Title words:</span>
         <h3><b data-array=~~titleWords~~>  <code>~~[value]~~</code></b></h3>
         <span>Author names:</span>
         <h3><b data-array=~~authorNames~~> <code>~~[value]~~</code></b></h3>
      </div>
      <hr>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <hr>
      <div class=dna-clone>
         <h3>Summary</h3>
         <p>Number of books: <b>3</b></p>
         <p>Total price: $<b>74.97</b></p>
      </div>
      <hr>
      <div class=dna-clone>
         <h3>Analytics</h3>
         <span>Title words:</span>
         <h3><b><code>css3 dom howdy html5 styling the</code></b></h3>
         <span>Author names:</span>
         <h3><b><code>Abby Ed Jan</code></b></h3>
      </div>
      <hr>
   </fieldset>
</section>
<script>
spec.spec22 = {
   run() {
      const sumPrice =       (sum, book) =>   sum + book.price;
      const addTitleWords =  (words, book) => words.concat(book.title.toLowerCase().split(' '));
      const addAuthorNames = (names, book) => names.concat(book.author.split(' '));
      const summary = {
         numBooks:   specRunner.catalog.length,
         totalPrice: specRunner.catalog.reduce(sumPrice, 0) / 100
         };
      const analytics = {
         titleWords:  specRunner.catalog.reduce(addTitleWords,  []).sort(),
         authorNames: specRunner.catalog.reduce(addAuthorNames, []).sort()
         };
      dna.insert('s22-summary',   summary);
      dna.insert('s22-analytics', { titleWords: ['bogus'], authorNames: ['also bogus'] });
      dna.insert('s22-analytics', analytics);
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<section id=spec23>
   <h3>Specification: #23</h3>
   <p>Formatters</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=s23-book class=dna-template data-transform=spec.spec23.addΣ>
            <h4>
               <span data-format=spec.spec23.up>~~title~~</span> *
               <span data-format=spec.spec23.up>~~author~~</span> *
               <span data-format=String.fromCharCode>~~price~~</span>
            </h4>
            <div>Event:</div>
            <output>
               <samp                               title=milliseconds>~~event~~</samp>
               <samp data-format-date=date         title=date>~~event~~</samp>
               <samp data-format-date=general      title=general>~~event~~</samp>
               <samp data-format-date=general-date title=general-date>~~event~~</samp>
               <samp data-format-date=general-time title=general-time>~~event~~</samp>
               <samp data-format-date=iso          title=iso>~~event~~</samp>
               <samp data-format-date=locale       title=locale>~~event~~</samp>
               <samp data-format-date=locale-date  title=locale-date>~~event~~</samp>
               <samp data-format-date=locale-time  title=locale-time>~~event~~</samp>
               <samp data-format-date=string       title=string>~~event~~</samp>
               <samp data-format-date=time         title=time>~~event~~</samp>
               <samp data-format-date=utc          title=utc>~~event~~</samp>
            </output>
            <div>Price: <input data-attr-type=number value=~~price~~></div>
            <output>
               <samp data-format-currency100=usd title=usd100>~~price~~</samp>
               <samp data-format-currency=usd    title=usd>~~price~~</samp>
               <samp data-format-currency=jpy    title=jpy>~~price~~</samp>
            </output>
            <div>
               <samp data-format-number=#          title=#>~~π~~</samp> |
               <samp data-format-number=#.####     title=#.####>~~π~~</samp> |
               <samp data-format-number=#.######## title=#.########>~~π~~</samp>
            </div>
            <div>
               <samp data-format-percent=#    title=#>~~σ~~</samp> |
               <samp data-format-percent=#.#  title=#.#>~~σ~~</samp> |
               <samp data-format-percent=#.## title=#.###>~~σ~~</samp>
            </div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <h4><span>THE DOM</span> * <span>JAN</span> * <span>&#2499;</span></h4>
            <div>Event:</div>
            <output>
               <samp title=milliseconds>47008800000</samp>
               <samp title=date>Mon Jun 28 1971</samp>
               <samp title=general>1971-06-28 7:00pm</samp>
               <samp title=general-date>1971-06-28</samp>
               <samp title=general-time>7:00pm</samp>
               <samp title=iso>1971-06-29T02:00:00.000Z</samp>
               <samp title=locale>6/28/1971, 7:00:00 PM</samp>
               <samp title=locale-date>6/28/1971</samp>
               <samp title=locale-time>7:00:00 PM</samp>
               <samp title=string>Mon Jun 28 1971 19:00:00 GMT-0700 (PDT)</samp>
               <samp title=time>19:00:00 GMT-0700 (PDT)</samp>
               <samp title=utc>Tue, 29 Jun 1971 02:00:00 GMT</samp>
            </output>
            <div>Price: <input type=number value=2499></div>
            <output>
               <samp title=usd100>$24.99</samp>
               <samp title=usd>$2,499.00</samp>
               <samp title=jpy>¥2,499</samp>
            </output>
            <div>
               <samp title=#>3</samp> |
               <samp title=#.####>3.1416</samp> |
               <samp title=#.########>3.14159265</samp>
            </div>
            <div>
               <samp title=#>71%</samp> |
               <samp title=#.#>70.7%</samp> |
               <samp title=#.##>70.71%</samp>
            </div>
         </div>
         <div class=dna-clone>
            <h4><span>STYLING CSS3</span> * <span>ABBY</span> * <span>&#1999;</span></h4>
            <div>Event:</div>
            <output>
               <samp title=milliseconds>1904112000000</samp>
               <samp title=date>Sat May 04 2030</samp>
               <samp title=general>2030-05-04 1:00am</samp>
               <samp title=general-date>2030-05-04</samp>
               <samp title=general-time>1:00am</samp>
               <samp title=iso>2030-05-04T08:00:00.000Z</samp>
               <samp title=locale>5/4/2030, 1:00:00 AM</samp>
               <samp title=locale-date>5/4/2030</samp>
               <samp title=locale-time>1:00:00 AM</samp>
               <samp title=string>Sat May 04 2030 01:00:00 GMT-0700 (PDT)</samp>
               <samp title=time>01:00:00 GMT-0700 (PDT)</samp>
               <samp title=utc>Sat, 04 May 2030 08:00:00 GMT</samp>
            </output>
            <div>Price: <input type=number value=1999></div>
            <output>
               <samp title=usd100>$19.99</samp>
               <samp title=usd>$1,999.00</samp>
               <samp title=jpy>¥1,999</samp>
            </output>
            <div>
               <samp title=#>3</samp> |
               <samp title=#.####>3.1416</samp> |
               <samp title=#.########>3.14159265</samp>
            </div>
            <div>
               <samp title=#>71%</samp> |
               <samp title=#.#>70.7%</samp> |
               <samp title=#.##>70.71%</samp>
            </div>
         </div>
         <div class=dna-clone>
            <h4><span>HOWDY HTML5</span> * <span>ED</span> * <span>&#2999;</span></h4>
            <div>Event:</div>
            <output>
               <samp title=milliseconds></samp>
               <samp title=date></samp>
               <samp title=general></samp>
               <samp title=general-date></samp>
               <samp title=general-time></samp>
               <samp title=iso></samp>
               <samp title=locale></samp>
               <samp title=locale-date></samp>
               <samp title=locale-time></samp>
               <samp title=string></samp>
               <samp title=time></samp>
               <samp title=utc></samp>
            </output>
            <div>Price: <input type=number value=2499></div>
            <output>
               <samp title=usd100>$24.99</samp>
               <samp title=usd>$2,499.00</samp>
               <samp title=jpy>¥2,499</samp>
            </output>
            <div>
               <samp title=#>3</samp> |
               <samp title=#.####>3.1416</samp> |
               <samp title=#.########>3.14159265</samp>
            </div>
            <div>
               <samp title=#>71%</samp> |
               <samp title=#.#>70.7%</samp> |
               <samp title=#.##>70.71%</samp>
            </div>
         </div>
      </div>
   </fieldset>
</section>
<script>
spec.spec23 = {
   addΣ(book) {
      book.σ = Math.SQRT1_2;
      },
   up(value) {
      return value.toUpperCase();
      },
   run() {
      const addπ = (book) => book.π = Math.PI;
      dna.clone('s23-book', specRunner.catalog, { transform: addπ });
      },
   };
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
</main>
<footer>
   dna.js <span class=version-number></span>
</footer>

<script src=https://cdn.jsdelivr.net/npm/jquery@3.6/dist/jquery.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/fetch-json@2.6/dist/fetch-json.min.js></script>
<script src=../dist/dna.dev.js></script>
<script>
const event1 = new Date('1971-06-28T19:00:00').getTime();  //June 28, 1971 at 7pm (local time)
const event2 = new Date('2030-05-04T01:00:00').getTime();  //May 4, 2030 at 1:00am (local time)
const specRunner = {
   catalog: [
      { title: 'The DOM',      author: 'Jan',  price: 2499, sale: false, language: 'en', event: event1 },
      { title: 'Styling CSS3', author: 'Abby', price: 1999, sale: true,  language: 'fr', event: event2 },
      { title: 'Howdy HTML5',  author: 'Ed',   price: 2999 }
      ],
   setup() {
      window.onerror = () => $('body').addClass('error-detected');
      $('body').toggleClass('minified-mode', window.location.pathname.endsWith('-min.html'));
      $('.version-number').text(dna.version === '[VERSION]' ? '' : 'v' + dna.version);
      const runSpec = (sectionNode) => {
         const name = $(sectionNode).attr('id');
         console.log(name);
         spec[name].run();
         };
      console.log('~~ dna.js ~~');
      console.log('Version: ' + dna.info().version);
      console.log('Specifications:');
      const start = Date.now();
      $('main >section').toArray().forEach(runSpec);
      console.log('Run time (msec):', Date.now() - start);
      console.log('Report:', dna.info());
      console.log('');
      },
   };
$(specRunner.setup);
</script>
</body>
</html>
