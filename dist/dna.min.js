//! dna.js v1.6.6 ~~ dnajs.org ~~ MIT License
function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_unsupportedIterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _iterableToArray(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a))return _arrayLikeToArray(a)}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var dna={version:"1.6.6",clone:function clone(a,b,c){var d,e=_objectSpread(_objectSpread({},{fade:!1,top:!1,container:null,empty:!1,clones:1,html:!1,transform:null,callback:null}),c),f=dna.store.getTemplate(a);f.nested&&!e.container&&dna.core.berserk("Container missing for nested template",a),e.empty&&dna.empty(a);var g=(d=[]).concat.apply(d,_toConsumableArray(Array(e.clones).fill(b))),h=$(),i=function(a,b){return h=h.add(dna.core.replicate(f,a,b,e))};return g.forEach(i),dna.placeholder.setup(),dna.panels.initialize(h.first().closest(".dna-panels")),h.first().parents(".dna-hide").removeClass("dna-hide").addClass("dna-unhide"),h},cloneSub:function cloneSub(a,b,c,d){var e=dna.compile.subTemplateName(a,b),f=".dna-contains-"+e,g={container:a.find(f).addBack(f)},h=dna.clone(e,c,_objectSpread(_objectSpread({},g),d));return dna.core.updateArray(h),h},createTemplate:function createTemplate(a,b,c){return $(b).attr({id:a}).addClass("dna-template").appendTo(c),dna.store.getTemplate(a)},templateExists:function templateExists(a){return!!dna.store.templates[a]||0<$(".dna-template#"+a).length},getModel:function getModel(a,b){return"string"==typeof a?function getAllModels(a){var b=[];return dna.getClones(a).each(function addToModel(a,c){return b.push(dna.getModel($(c)))}),b}(a):function getOneModel(a){return dna.getClone($(a),b).data("dnaModel")}(a)},empty:function empty(a,b){var c=_objectSpread(_objectSpread({},{fade:!1,callback:null}),b),d=dna.store.getTemplate(a),e=d.container.children(".dna-clone");d.container.data().dnaCountsMap&&(d.container.data().dnaCountsMap[a]=0);return c.fade?function fadeDelete(){return dna.ui.slideFadeDelete(e,c.callback)}():dna.core.remove(e,c.callback)},insert:function insert(a,b,c){var d=dna.getClones(a).first();return d.length?dna.refresh(d,{data:b,html:c&&c.html}):dna.clone(a,b,c)},refresh:function refresh(a,b){var c=_objectSpread(_objectSpread({},{html:!1}),b),d=dna.getClone(a,b),e=c.data?c.data:dna.getModel(d);return dna.core.inject(d,e,d.data().dnaCount,c)},refreshAll:function refreshAll(a,b){return dna.getClones(a).each(function refresh(a,c){return dna.refresh($(c),b)})},updateField:function updateField(a,b){var c=a.data()&&a.data().dnaField;return c&&function update(){a.is("input:checkbox")?a.prop("checked",b):a.is("input:radio")?a.prop("checked",b):a.is("input, select, textarea")&&a.val(b),dna.getModel(a)[c]=b}(),a},recount:function recount(a,b){a=dna.getClone(a);var c=function(){var c=a.data().dnaRules.template,d=a.parent(),e=d.children(".dna-clone."+c).each(function update(a,c){c=$(c),c.data().dnaCount=a+1,dna.refresh(c,b)});d.data().dnaCountsMap=d.data().dnaCountsMap||{},d.data().dnaCountsMap[c]=e.length};return a.length&&c(),a},destroy:function destroy(a,b){var c=_objectSpread(_objectSpread({},{fade:!1,callback:null}),b);a=dna.getClone(a,b);var d=dna.core.getArrayName(a);d&&dna.getModel(a.parent())[d].splice(dna.getIndex(a),1);var e=function(){return dna.ui.slideFadeDelete(a,c.callback)};return c.fade?e():dna.core.remove(a,c.callback)},getClone:function getClone(a,b){var c=_objectSpread(_objectSpread({},{main:!1}),b),d=c.main?".dna-clone:not(.dna-sub-clone)":".dna-clone";return a instanceof $?a.closest(d):$()},getClones:function getClones(a){return dna.store.getTemplate(a).container.children(".dna-clone."+a)},getIndex:function getIndex(a,b){var c=dna.getClone(a,b);return c.parent().children(".dna-clone."+c.data().dnaRules.template).index(c)},up:function up(a,b){return dna.ui.smoothMoveUp(dna.getClone(dna.ui.toElem(a,this)),b)},down:function down(a,b){return dna.ui.smoothMoveDown(dna.getClone(dna.ui.toElem(a,this)),b)},bye:function bye(a,b){var c=dna.ui.toElem(a,this),d={fade:!0,callback:"function"==typeof b?b:null};return dna.destroy(c,d)},registerInitializer:function registerInitializer(a,b){var c=_objectSpread(_objectSpread({},{onDocumentLoad:!0}),b);c.onDocumentLoad&&dna.util.apply(a,[function getElems(a){return a?$(a).not(".dna-template "+a).addClass("dna-initialized"):$(window.document)}(c.selector)].concat(c.params));var d={func:a,selector:c.selector,params:c.params};return dna.events.initializers.push(d),dna.events.initializers},clearInitializers:function clearInitializers(){dna.events.initializers=[]},registerContext:function registerContext(a,b){return dna.events.context[a]=b,dna.events.context},info:function info(){var a=Object.keys(dna.store.templates),b=$(".dna-menu.dna-panels-initialized");return{version:dna.version,templates:a.length,clones:$(".dna-clone:not(.dna-sub-clone)").length,subs:$(".dna-sub-clone").length,names:a,store:dna.store.templates,initializers:dna.events.initializers,panels:b.toArray().map(function(a){return $(a).attr("data-nav")})}}};dna.array={find:function find(a,b,c){var d=Array.isArray(a),e=0;if(d)for(;e<a.length&&a[e][c||"code"]!==b;)e++;return d&&e<a.length?{item:a[e],index:e}:{item:void 0,index:-1}},last:function last(a){return Array.isArray(a)&&a.length?a[a.length-1]:void 0},fromMap:function fromMap(a,b){var c=_objectSpread(_objectSpread({},{key:"code",kebabCodes:!1}),b),d=[],e=function(a){return a instanceof Object?a:{value:a}};for(var f in a)d[d.push(e(a[f]))-1][c.key]=c.kebabCodes?dna.util.toKebab(f):f;return d},toMap:function toMap(a,b){var c=_objectSpread(_objectSpread({},{key:"code",camelKeys:!1}),b),d={};return a.forEach(c.camelKeys?function addObjCamelKey(a){return d[dna.util.toCamel(a[c.key])]=a}:function addObj(a){return d[a[c.key]]=a}),d},wrap:function wrap(a){return a?a instanceof Array?a:[a]:[]}},dna.browser={getUrlParams:function getUrlParams(){var a={},b=function(b){return a[b.split("=")[0]]=b.split("=")[1]};return window.location.search.slice(1).split("&").forEach(function(a){return a&&b(a)}),a}},dna.pageToken={put:function put(a,b){return window.sessionStorage[a+window.location.pathname]=JSON.stringify(b),b},get:function get(a,b){var c=window.sessionStorage[a+window.location.pathname];return c===void 0?b:JSON.parse(c)}},dna.ui={deleteElem:function deleteElem(a,b){return b="function"==typeof b?b:null,dna.core.remove(dna.ui.toElem(a,this),b)},focus:function focus(a){return a.trigger("focus")},getAttrs:function getAttrs(a){return a[0]?Object.values(a[0].attributes):[]},getComponent:function getComponent(a){return a.closest("[data-component]")},pulse:function pulse(a,b){var c=_objectSpread(_objectSpread({},{duration:400,interval:null,out:5e3}),b),d={hide:{opacity:0},show:{opacity:1}};return a.stop(!0).slideDown().css(d.hide).animate(d.show,c.duration),c.interval&&a.animate(d.show,c.interval).animate(d.hide,c.out),a},slideFade:function slideFade(a,b,c){var d={opacity:1,transition:"opacity 400ms"},e={transition:"opacity 0s"};return c&&window.setTimeout(function doEaseIn(){return a.css(d)},200)?a.css({opacity:0,transition:"opacity 0s"}).hide().delay(100).slideDown(b):a.css({opacity:0,transition:"opacity 400ms"}).delay(100).slideUp(b),a.delay(200).promise().then(function clearTransition(){return a.css(e)}),a},slideFadeIn:function slideFadeIn(a,b){return dna.ui.slideFade(a,b,!0)},slideFadeOut:function slideFadeOut(a,b){return dna.ui.slideFade(a,b,!1)},slideFadeToggle:function slideFadeToggle(a,b){return dna.ui.slideFade(a,b,a.is(":hidden"))},slideFadeDelete:function slideFadeDelete(a,b){return dna.ui.slideFadeOut(a,function(){return dna.ui.deleteElem(a,b)})},smoothHeightSetBaseline:function smoothHeightSetBaseline(a){dna.ui.$container=a=a||$("body");var b=a.outerHeight();return a.css({minHeight:b,maxHeight:b,overflow:"hidden"})},smoothHeightAnimate:function smoothHeightAnimate(a,b){b=b||dna.ui.$container;var c=function(){b.css({minHeight:0,maxHeight:"100vh"});var a=function(){return b.css({transition:"none",maxHeight:"none"})};window.setTimeout(a,1e3)};window.setTimeout(c,a||50);var d=function(){return b.css({transition:"all 1s"})};return window.setTimeout(d,10),b},smoothMove:function smoothMove(a,b,c){c="function"==typeof c?c:null;var d=b?a.prev():a.next();return d.length?function move(){var e=d.clone(!0);b?a.after(d.hide()).before(e):a.before(d.hide()).after(e);var f=0,g=function(){return f++&&c&&c(a)};window.setTimeout(function animate(){dna.ui.slideFadeIn(d,g),dna.ui.slideFadeDelete(e,g)})}():c&&c(a),a},smoothMoveUp:function smoothMoveUp(a,b){return dna.ui.smoothMove(a,!0,b)},smoothMoveDown:function smoothMoveDown(a,b){return dna.ui.smoothMove(a,!1,b)},toElem:function toElem(a,b){var c=a instanceof $&&a,d=a&&a.target;return c||$(d||a||b)}},dna.util={apply:function apply(a,b){var c,d=void 0===b?[]:[].concat(b),e=d[0],f=function(b,g){b&&(1!==g.length||"function"==typeof b[g[0]])?1===g.length?c=b[g[0]].apply(e,d):f(b[g[0]],g.slice(1)):dna.core.berserk("Callback function not found",a)};return e instanceof $&&0===e.length?c=e:"function"==typeof a?c=a.apply(e,d):e&&e[a]?c=e[a](d[1],d[2],d[3]):""===a||{number:!0,boolean:!0}[_typeof(a)]?dna.core.berserk("Invalid callback function",a):"string"==typeof a&&0<a.length&&function findFn(a){e instanceof $&&d.push(dna.ui.getComponent(e));var b=a[0],c=(null,eval);/^[_$a-zA-Z][_$a-zA-Z0-9]*$/.test(b)&&function unknown(a){return void 0===window[a]&&!dna.events.context[a]}(b)&&function callable(a){return["object","function"].includes(c("typeof "+a))}(b)&&dna.registerContext(b,c(b)),f(dna.events.context[b]?dna.events.context:window,a)}(a.split(".")),c},assign:function assign(a,b,c){var d="string"==typeof b?b.split("."):b,e=d[0],f=$.isPlainObject(a)?a:{};return 1===d.length?f[e]=c:dna.util.assign(function nestedData(){return void 0===f[e]?f[e]={}:f[e]}(),d.slice(1),c),f},printf:function printf(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return c.reduce(function(a,b){return a.replace(/%s/,b)},a)},realTruth:function realTruth(a){return!!a&&!function emptyArray(){return a instanceof Array&&0===a.length}()&&!function falseyStr(){return /^(f|false|n|no|0)$/i.test(a)}()},toCamel:function toCamel(a){return(""+a).replace(/\-(.)/g,function hump(a,b){return b.toUpperCase()})},toKebab:function toKebab(a){return(""+a).replace(/([A-Z]+)/g,function dash(a){return"-"+a.toLowerCase()}).replace(/\s|^-/g,"")},value:function value(a,b){return"string"==typeof b&&(b=b.split(".")),null===a||void 0===a||void 0===b?null:1===b.length?a[b[0]]:dna.util.value(a[b[0]],b.slice(1))}},dna.placeholder={setup:function setup(){$("option.dna-template").closest("select").addClass("dna-hide");$("[data-placeholder]").each(function fade(a,b){var c=$(b).stop(!0);return dna.getClones(c.data().placeholder).length?c.fadeOut():c.fadeIn()})}},dna.panels={display:function display(a,b,c){var d=a.data().dnaPanels,e=a.data().nav,f=a.find(".menu-item"),g=function bound(a){return Math.max(0,Math.min(a,f.length-1))}(b===void 0?dna.pageToken.get(e,0):b);a[0].selectedIndex=g,f.removeClass("selected").addClass("unselected"),f.eq(g).addClass("selected").removeClass("unselected"),d.hide().removeClass("displayed").addClass("hidden");var h=d.eq(g).fadeIn().addClass("displayed").removeClass("hidden"),i=h.data().hash;dna.pageToken.put(e,g),c&&i&&window.history.pushState(null,null,"#"+i),dna.util.apply(a.data().callback,[h,i])},clickRotate:function clickRotate(a){var b=$(a.target).closest(".menu-item"),c=b.closest(".dna-menu");dna.panels.display(c,c.find(".menu-item").index(b),!0)},selectRotate:function selectRotate(a){var b=$(a.target);dna.panels.display(b,b.find("option:selected").index(),!0)},nextNav:1,initialize:function initialize(a){var b=function(b){a.attr("data-nav",b).addClass("dna-legacy-id"),$("#"+b+"-menu").attr("data-nav",b).addClass("dna-legacy-id"),a.data().nav=b},c=function(){var b="dna-panels-"+dna.panels.nextNav++;return a.attr("data-nav",b).prev(".dna-menu").attr("data-nav",b),b},d=!a.length||a.hasClass("dna-panels-initialized");d||a.children().hasClass("dna-template")||function init(){!a.data().nav&&/-panels$/.test(a.attr("id"))&&b(a.attr("id").replace(/-panels$/,""));var d=a.data().nav||c(),e=$(".dna-menu[data-nav="+d+"]").addClass("dna-panels-initialized"),f=a.addClass("dna-panels-initialized").children().addClass("panel"),g=window.location.hash.replace(/[^\w-]/g,""),h=g&&f.first().data().hash?function hashIndex(){return f.filter("[data-hash="+g+"]").index()}():function savedIndex(){return dna.pageToken.get(d,0)}();e.length||dna.core.berserk("Menu not found for panels",d),e.data().dnaPanels=f,e.find(".menu-item").length||e.children().addClass("menu-item"),dna.panels.display(e,h)}()},setup:function setup(){$(".dna-panels").each(function(a,b){return dna.panels.initialize($(b))}),$(window.document).on({click:dna.panels.clickRotate},".dna-menu .menu-item"),$(window.document).on({change:dna.panels.selectRotate},".dna-menu")}},dna.compile={regexDnaField:/^[\s]*(~~|\{\{).*(~~|\}\})[\s]*$/,regexDnaBasePair:/~~|{{|}}/,regexDnaBasePairs:/~~|\{\{|\}\}/g,setupNucleotide:function setupNucleotide(a){return a.data().dnaRules||(a.data().dnaRules={}),a.addClass("dna-nucleotide")},isDnaField:function isDnaField(a,b){var c=b.childNodes[0];return c&&c.nodeValue&&function matches(){return c.nodeValue.match(dna.compile.regexDnaField)}()},field:function field(a,b){return b=dna.compile.setupNucleotide($(b)),b.data().dnaField=b.text().replace(dna.compile.regexDnaBasePairs,"").trim(),b.is("textarea")?b.addClass("dna-update-model").data().dnaRules.val=!0:b.data().dnaRules.text=!0,b.empty()},propsAndAttrs:function propsAndAttrs(a,b){b=$(b);var c=[],d=[],e=[],f=function(a,d){e.push(a),a=a.replace(/^data-prop-/,"").toLowerCase(),d=d.replace(dna.compile.regexDnaBasePairs,""),c.push(a,d),"checked"===a&&b.is("input")&&(b.addClass("dna-update-model").data().dnaField=d)},g=function(a,c){var f=c.split(dna.compile.regexDnaBasePair);"[count]"===f[1]?f[1]=1:"[value]"===f[1]&&(f[1]=2),d.push(a.replace(/^data-attr-/,""),f),e.push(a);var g=function(){dna.compile.setupNucleotide(b).addClass("dna-update-model"),b.data().dnaField=f[1],b.data().dnaRules.val=!0},h=b.is("input:not(:checkbox, :radio)")&&"value"===a&&""===f[0]&&""===f[2];(h||b.is("select")&&"data-option"===a)&&g()};return dna.ui.getAttrs(b).forEach(function compile(a){/^data-prop-/.test(a.name)?f(a.name,a.value):3===a.value.split(dna.compile.regexDnaBasePair).length&&g(a.name,a.value)}),0<c.length&&(dna.compile.setupNucleotide(b).data().dnaRules.props=c),0<d.length&&(dna.compile.setupNucleotide(b).data().dnaRules.attrs=d),b.data().transform&&(dna.compile.setupNucleotide(b).data().dnaRules.transform=b.data().transform),b.data().callback&&(dna.compile.setupNucleotide(b).data().dnaRules.callback=b.data().callback),b.removeAttr(e.join(" "))},getDataField:function getDataField(a,b){return a.data(b).replace(dna.compile.regexDnaBasePairs,"").trim()},subTemplateName:function subTemplateName(a,b){var c=a instanceof $&&function getClone(){return dna.getClone(a,{main:!0})}().data().dnaRules.template;return(c||a)+"-"+b+"-instance"},rules:function rules(a,b,c){return a.filter("[data-"+b+"]").each(function addRule(a,d){d=dna.compile.setupNucleotide($(d));var e=dna.compile.getDataField(d,b);d.data().dnaRules[b]=c?function makeLists(){return e.split(";").map(function(a){return a.split(",")})}():e}).removeAttr("data-"+b)},separators:function separators(a){var b=function(a,b){return 3===b.nodeType&&!/\S/.test(b.nodeValue)},c=function(a,c,d){return c&&function doAppend(){a.contents().last().filter(b).remove(),a.append($("<span>").addClass(d).html(c))}()};a.find(".dna-template, .dna-sub-clone").addBack().each(function processTemplate(a,b){var d=$(b);c(d,d.data().separator,"dna-separator"),c(d,d.data().lastSeparator,"dna-last-separator")})},template:function template(a){var b=$("#"+a);b.length||dna.core.berserk("Template not found",a);var c=function(a,b){return $(b).data().dnaRules.subs=[]};b.find(".dna-template").addBack().each(function saveName(a,b){return $(b).data().dnaRules={template:$(b).attr("id"),subs:[]}}).removeAttr("id").each(c);var d=b.find("*").addBack();d.filter(dna.compile.isDnaField).each(dna.compile.field).addClass("dna-field"),dna.compile.rules(d,"array").addClass("dna-sub-clone").each(c),dna.compile.rules(d,"class",!0),dna.compile.rules(d,"require"),dna.compile.rules(d,"missing"),dna.compile.rules(d,"true"),dna.compile.rules(d,"false"),d.each(dna.compile.propsAndAttrs),dna.compile.separators(b);return $("input[data-attr-type]").each(function setTypeAttr(a,b){return $(b).attr({type:$(b).data().attrType})}),dna.store.stash(b)}},dna.store={templates:{},stash:function stash(a){var b=a.data().dnaRules.template,c=function(a,b){b=$(b);var c=b.data().dnaRules.template,d=b.parent(),e=1===d.children().length&&!d.hasClass("dna-container");e||d.data().dnaContents||function compileSiblings(){d.data().dnaContents=!0;var a=function(a){a=$(a);return a.hasClass("dna-template")?function compileToName(a){return a?dna.compile.template(a).name:c}(a.attr("id")):!!a.hasClass("dna-sub-clone")&&a.data().dnaRules.template};d.data().dnaContents=d.children().toArray().map(a)}();var f={name:c,elem:b,container:d.addClass("dna-container").addClass("dna-contains-"+c),nested:0!==d.closest(".dna-clone").length,separators:b.find(".dna-separator, .dna-last-separator").length,wrapped:e};dna.store.templates[c]=f,b.removeClass("dna-template").addClass("dna-clone").addClass(c).detach()};return a.find(".dna-template").addBack().each(c),a.find(".dna-sub-clone").each(function prepLoop(a,c){var d=$(c).data().dnaRules,e=dna.compile.setupNucleotide($(c).parent()).addClass("dna-array");d.template=dna.compile.subTemplateName(b,d.array),e.data().dnaRules.loop={name:d.template,field:d.array},e.closest(".dna-clone, .dna-sub-clone").data().dnaRules.subs.push(d.array)}).each(c),dna.store.templates[b]},getTemplate:function getTemplate(a){return dna.store.templates[a]||dna.compile.template(a)}},dna.events={context:{},initializers:[],runOnLoads:function runOnLoads(){return $("[data-on-load]").not(".dna-loaded").each(function run(a,b){return dna.util.apply($(b).data().onLoad,$(b))}).addClass("dna-loaded")},runInitializers:function runInitializers(a){return dna.events.initializers.forEach(function init(b){var c=b.selector?function find(){return a.find(b.selector).addBack(b.selector)}():a,d=[c.addClass("dna-initialized")].concat(b.params);dna.util.apply(b.func,d)}),a},setup:function setup(){var a=function(b,c,d){var e=b.closest("[data-"+c+"]"),f=e.data(c),g=e[0]&&"A"===e[0].nodeName;"click"===c&&g&&f&&f.match(/^dna[.]/)&&d.preventDefault();var h=e.parent().closest("[data-click]");return"click"===c&&h.length&&a(h,c,d),dna.util.apply(f,[e,d])},b=function(b){var c=$(b.target),d=function(a,b){return dna.util.assign(dna.getModel(a),a.data().dnaField,b(a))},e=function(a){return a.val()},f=function(a){return a.is(":checked")},g=function(a,b){return d($(b),f)};return c.hasClass("dna-update-model")&&function updateModel(){var a=dna.getClone(c,{main:!0});0===a.length||(c.is("input:checkbox")?d(c,f):c.is("input:radio")?$("input:radio[name="+c.attr("name")+"]").each(g):c.data().dnaRules.val&&d(c,e),dna.refresh(a))}(),a(c,b.type.replace("key","key-"),b)},c=function(b){var c=$(b.target),d=c.data(),e=function(){d.dnaLastUpdated=Date.now(),d.dnaLastValue=c.val(),d.dnaTimeoutId=null,a(c,"smart-update",b)},f=function(){var a=d.smartThrottle?+d.smartThrottle:1000;Date.now()<d.dnaLastUpdated+a?d.dnaTimeoutId=window.setTimeout(e,a):e()},g=function(){c.val()===d.dnaLastValue||d.dnaTimeoutId||f()};d.smartUpdate&&function processSmartUpdate(){"keydown"===b.type&&d.dnaLastValue===void 0&&(d.dnaLastValue=c.val()),window.setTimeout(g)}()},d=function(b){return function(c){return a($(c.target),b,c)}};$(window.document).on({click:b,change:b,keydown:b,keypress:b,keyup:b,input:b}).on({keydown:c,keyup:c,change:c,cut:c,paste:c}).on({keyup:function handleEnterKey(b){return 13===b.which&&a($(b.target),"enter-key",b)}}).on({click:function jumpToUrl(a){var b=$(a.target).closest("[data-href]"),c=/iPad|iPhone|iPod/.test(window.navigator.userAgent)&&/Apple/.test(window.navigator.vendor),d=b.closest(".external-site").length?"_blank":"_self";window.open(b.data().href,c?"_self":b.data().target||d)}},"[data-href]").on({focusin:d("focus-in")},"[data-focus-in]").on({focusout:d("focus-out")},"[data-focus-out]").on({mouseenter:d("hover-in")},"[data-hover-in]").on({mouseleave:d("hover-out")},"[data-hover-out]"),dna.events.runOnLoads()}},dna.core={inject:function inject(a,b,c,d){var e=function(a,e){var f="[count]"===e?c:"[value]"===e?b:dna.util.value(b,e);({string:!0,number:!0,boolean:!0})[_typeof(f)]&&(a=d.html?a.html(f):a.text(f))},f=function(a,d){var e="[count]"===d?c:"[value]"===d?b:dna.util.value(b,d);null!==e&&e!==a.val()&&a.val(e)},g=function(a,c){for(var d=0;d<c.length/2;d++)a.prop(c[2*d],dna.util.realTruth(dna.util.value(b,c[2*d+1])))},h=function(a,d){for(var j=0;j<d.length/2;j++){var e=d[2*j],f=d[2*j+1],g=f[1],h=1===g?c:2===g?b:dna.util.value(b,g),i=[f[0],h,f[2]].join("");a.attr(e,i),/^data-./.test(e)&&a.data(e.substring(5),i),"value"===e&&i!==a.val()&&a.val(i)}},j=function(a,c){c.forEach(function process(c){var d=dna.util.value(b,c[0]),e=dna.util.realTruth(d);1===c.length?a.addClass(d):1<c.length&&function setBooleanClasses(){a.toggleClass(c[1],e),c[2]&&a.toggleClass(c[2],!e)}()})},k=function(a){var c=dna.util.value(b,a);return void 0!==c&&null!==c},l=function(a,c){var e=dna.util.value(b,c.field),f=a.children("."+c.name.replace(/[.]/g,"\\."));e?e.length===f.length?f.each(function injectSubClone(a,b){b=$(b),b.is("option")||dna.core.inject(b,e[a],a+1,d)}):function rebuildSubClones(){f.remove(),dna.clone(c.name,e,{container:a,html:d.html})}():b[c.field]=[]},m=function process(a,c){c=$(c);var d=c.data().dnaRules;d.transform&&dna.util.apply(d.transform,b),d.loop&&l(c,d.loop),d.text&&e(c,c.data().dnaField),d.val&&f(c,c.data().dnaField),d.props&&g(c,d.props),d.attrs&&h(c,d.attrs),d["class"]&&j(c,d["class"]),d.require&&c.toggle(k(d.require)),d.missing&&c.toggle(!k(d.missing)),d["true"]&&c.toggle(dna.util.realTruth(dna.util.value(b,d["true"]))),d["false"]&&c.toggle(!dna.util.realTruth(dna.util.value(b,d["false"]))),d.callback&&dna.util.apply(d.callback,c)},n=function(a){a.filter(".dna-nucleotide").each(m),a.length&&n(a.children().not(".dna-sub-clone"))};return d.transform&&d.transform(b),n(a),a.data().dnaModel=b,a.data().dnaCount=c,a},replicate:function replicate(a,b,c,d){var e=".dna-contains-"+a.name.replace(/[.]/g,"\\."),f=d.container?d.container.find(e).addBack(e):a.container,g=a.elem.clone(!0,!0),h=g.data().dnaRules.template;f.data().dnaCountsMap||(f.data().dnaCountsMap={});var i=f.data().dnaCountsMap;i[h]=(i[h]||0)+1,dna.core.inject(g,b,i[h],d);return a.wrapped?d.top?f.prepend(g):f.append(g):function intoUnwrapped(){var b=f.children(".dna-clone"),c=b.filter("."+a.name);c.length?d.top?c.first().before(g):c.last().after(g):function firstClone(){var c=f.data().dnaContents,d=c.indexOf(a.name),e=f.children().eq(d+c.reduce(function adjustment(a,e){return a+(e&&c.indexOf(e)<d?b.filter("."+e).length-1:0)},0));e.length?e.before(g):f.append(g)}()}(),a.separators&&function displaySeparators(){var b=f.children("."+a.name);b.find(".dna-separator").show().end().last().find(".dna-separator").hide(),b.find(".dna-last-separator").hide().end().eq(-2).find(".dna-last-separator").show().closest(".dna-clone").find(".dna-separator").hide()}(),dna.events.runInitializers(g,b),d.callback&&d.callback(g,b),d.fade&&dna.ui.slideFadeIn(g),g},getArrayName:function getArrayName(a){return a.hasClass("dna-sub-clone")?a.data().dnaRules.array:null},updateArrayByName:function updateArrayByName(a,b){var c=function(){a=dna.getClone(a);var c=dna.compile.subTemplateName(a,b);return a.data().dnaRules.subs.includes(b)&&(dna.getModel(a)[b]=a.find("."+c).get().map(dna.getModel)),a};return b?c():a},updateArray:function updateArray(a){return a=dna.getClone(a.first()),dna.core.updateArrayByName(a.parent(),dna.core.getArrayName(a)),a},remove:function remove(a,b){var c=a.parent();return a.detach(),dna.core.updateArrayByName(c,dna.core.getArrayName(a)),dna.placeholder.setup(),a.remove(),b&&b(a),a},berserk:function berserk(a,b){throw Error("dna.js ~~ "+a+" ["+b+"]")},plugin:function plugin(){$.fn.dna=function(a){var b=[arguments[1],arguments[2],arguments[3]],c=dna[dna.util.toCamel(a)];c||dna.core.berserk("Unknown plugin action",a);return this.each(function callApi(a,d){return c($(d),b[0],b[1],b[2])})}},initModule:function initModule(a,b){return window=a,$=b,window.dna=dna,dna.core.setup(),dna},setup:function setup(){dna.core.plugin(),$(dna.placeholder.setup),$(dna.panels.setup),$(dna.events.setup)}},"object"===("undefined"==typeof window?"undefined":_typeof(window))&&(window.dna=dna),"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=dna.core.initModule:dna.core.setup();
